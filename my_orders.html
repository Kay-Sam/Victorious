<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Orders</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<style>
.container { max-width: 700px; margin-top: 80px; }
.order-box { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
#order-details { margin-top: 20px; }
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top px-4 py-2">
  <a class="navbar-brand" href="index.html">Victorious Chips</a>
  <div class="collapse navbar-collapse">
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="shop.html">Shop</a></li>
      <li class="nav-item"><a class="nav-link" href="my_orders.html">My Orders</a></li>
    </ul>
  </div>
</nav>

<div class="container">
  <div class="order-box">
    <h4><i class="bi bi-card-checklist"></i> Track Your Order</h4>
    <p>Enter your order reference number below:</p>
    <div class="input-group mb-3">
      <input type="text" id="ref-input" class="form-control" placeholder="e.g. 6d956bce-2560-47ce-ba55-b492c112df23">
      <button class="btn btn-orange" id="track-btn">Track</button>
    </div>

    <div id="order-details" class="mt-4"></div>
  </div>
</div>

<script>
document.getElementById("track-btn").addEventListener("click", async () => {
  const ref = document.getElementById("ref-input").value.trim();
  const details = document.getElementById("order-details");
  details.innerHTML = "";

  if (!ref) {
    alert("Please enter a reference number.");
    return;
  }

  try {
    const res = await fetch(`https://victoriouschips.onrender.com/track-order?reference=${ref}`);
    if (!res.ok) throw new Error("Order not found");

    const data = await res.json();

    let itemsHTML = "<ul class='list-group'>";
    data.items.forEach(item => {
      itemsHTML += `<li class='list-group-item d-flex justify-content-between'>
        ${item.name} (x${item.qty}) <span>₦${item.price.toLocaleString()}</span>
      </li>`;
    });
    itemsHTML += "</ul>";

    details.innerHTML = `
      <h5>Order ID: ${data.order_id}</h5>
      <p>Status: <strong>${data.status}</strong></p>
      <p>Total: ₦${data.total.toLocaleString()}</p>
      <h6>Items:</h6>
      ${itemsHTML}
    `;

  } catch (err) {
    details.innerHTML = `<div class="alert alert-danger">Error: ${err.message}</div>`;
  }
});
</script>

<style>
.btn-orange { background: #ff7a00; color: #fff; }
.btn-orange:hover { background: #e96c00; color: #fff; }
</style>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
